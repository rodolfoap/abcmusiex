cat > Makefile << EOF
bin_PROGRAMS = abcmusiex abcmusiex-gui
abcmusiex_SOURCES = abcmusiex.c abcmusiex.h definitions.h functions.c functions.h abcmusiex-gui.c
man1_MANS = abcmusiex.1

all:	abcmusiex abcmusiex-gui abcmusiex.1

.PHONY: clean

abcmusiex.1: abcmusiex
	help2man ./abcmusiex > abcmusiex.1

abcmusiex: abcmusiex.c abcmusiex.h definitions.h functions.c functions.h
	gcc -ggdb -o abcmusiex abcmusiex.c abcmusiex.h definitions.h functions.c functions.h

abcmusiex-gui: abcmusiex-gui.c
	gtk-builder-convert abcmusiex-gui.glade abcmusiex-gui.gtk
	gcc -ggdb -o abcmusiex-gui -lconfig `pkg-config --cflags --libs gtk+-2.0 gmodule-export-2.0` abcmusiex-gui.c

install:
	mkdir -p \$(DESTDIR)/usr/bin/
	mkdir -p \$(DESTDIR)/usr/share/man/man1/
	mkdir -p \$(DESTDIR)/usr/share/abcmusiex/
	mkdir -p \$(DESTDIR)/usr/share/applications/
	install -m 0755 abcmusiex \$(DESTDIR)/usr/bin/
	install -m 0755 abcmusiex-gui \$(DESTDIR)/usr/bin/
	install -m 0755 abcmusiex.1 \$(DESTDIR)/usr/share/man/man1/
	install -m 0755 abcmusiex.png \$(DESTDIR)/usr/share/abcmusiex/
	install -m 0755 abcmusiex-gui.gtk \$(DESTDIR)/usr/share/abcmusiex/
	install -m 0755 abcmusiex-gui.glade \$(DESTDIR)/usr/share/abcmusiex/
	install -m 0755 abcmusiex.desktop \$(DESTDIR)/usr/share/applications/

uninstall:
	rm -rf /usr/bin/abcmusiex
	rm -rf /usr/bin/abcmusiex-gui
	rm -rf /usr/share/man/man1/abcmusiex.1
	rm -rf /usr/share/abcmusiex/
	rm -rf /usr/share/applications/abcmusiex.desktop

clean:
	rm -f abcmusiex abcmusiex-gui abcmusiex.1.gz abcmusiex-gu.gtk
EOF
